<!DOCTYPE html>
<html lang="jp">
  <head>
    <meta charset="utf-8">
    <title>Text_To_Music</title>
    <style>
      #title{
        margin-bottom: 0;
      }
      #mubert_text{
        font-size: .8em;
      }
      .section{
        margin-bottom: 2em;
      }
    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
    <script>
      $(function () {
        $('#send_prompt_button').click(function () {
          let confirm_text = 'Are you sure to send?';
          let confirm_result = confirm(confirm_text)
          if (confirm_result !== true) {
            alert('Canceld');
            return
          }

          let request_data = {
            'email': $('#email').val(),
            'prompt': $('#prompt').val(),
            'duration': $('#duration').val(),
            'loop': $('#loop').val()
          }

          $.ajax({
            url: '/audio',
            type: 'POST',
            contentType: 'application/json',
            dataType: 'json',
            data: JSON.stringify(request_data),
            success: function (response) {
              let trackurl = response['trackurl'];
              let result_message = response['result_message'];
              //let tags = response['tags'];
              $('#audio_area').text(trackurl)
              $('#audio_area').attr('href', trackurl);
              $('#result').val(result_message)
              console.log(trackurl);
              console.log(result_message);
              //console.log(tags);
            },
            error: function (response) {
              alert('Send falied', error)
            }
          })
        })
      })
    </script>
  </head>
  <body>
    <div class="section">
      <h1 id="title">Text_To_Music(Mubert)</h1>
      <div id="mubert_text">all music is generated by Mubert API - <a href="https://mubert.com/" target="_blank"></a>www.mubert.com</div>
    </div>

    <div class="section">
      <p>email: <input id="email" size="100" type="text"></p>
      <p>prompt: <input id="prompt" size="100" type="text"></p>
      <p>duration(sec): <input id="duration" type="text"></p>
      <p>loop: <input id="loop" type="checkbox"></p>
      <button id="send_prompt_button">Send</button>
    </div>

    <div class="section">
      <h2>Audio</h2>
      <div><a id="audio_area" href="" target="_blank">your audio url will be generated here.</a></div>
      <h2>Result Message</h2>
      <textarea id="result" rows="1" cols="100"></textarea>
    </div>
  </body>
</html>
